(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{413:function(t,_,a){"use strict";a.r(_);var v=a(17),s=Object(v.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"netstat"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#netstat"}},[t._v("#")]),t._v(" netstat")]),t._v(" "),_("p",[t._v("netstat 命令用于显示各种网络相关信息，如网络连接，路由表，接口状态 (Interface Statistics)，masquerade 连接，多播成员 (Multicast Memberships) 等等。")]),t._v(" "),_("h2",{attrs:{id:"参数说明"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[t._v("#")]),t._v(" 参数说明")]),t._v(" "),_("ul",[_("li",[t._v("-a 或 -all             显示所有套接字")]),t._v(" "),_("li",[t._v("-c 或 -continuous      持续列出网络状态")]),t._v(" "),_("li",[t._v("-t 或 -tcp             仅显示tcp相关选项")]),t._v(" "),_("li",[t._v("-u 或 -udp             仅显示udp相关选项")]),t._v(" "),_("li",[t._v("-n 或 -numeric         拒绝显示别名，能显示数字的全部转化为数字")]),t._v(" "),_("li",[t._v("-l 或 -listening       仅列出在Listen(监听)的服务状态")]),t._v(" "),_("li",[t._v("-p 或 -programs        显示对应的可执行程序名字(linux)")]),t._v(" "),_("li",[t._v("-s 或 -statistice      显示每个协议的统计数据")]),t._v(" "),_("li",[t._v("-M 或 –masquerade      显示伪装的网络连线")]),t._v(" "),_("li",[t._v("-h 或 –help            帮助")]),t._v(" "),_("li",[t._v("-r                     显示路由表")]),t._v(" "),_("li",[t._v("-o(windows)            显示拥有的与每个连接关联的进程ID")]),t._v(" "),_("li",[t._v("-b(windows)            显示对应的可执行程序名字")])]),t._v(" "),_("h2",{attrs:{id:"查询tcp连接数"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#查询tcp连接数"}},[t._v("#")]),t._v(" 查询TCP连接数")]),t._v(" "),_("div",{staticClass:"language-bash extra-class"},[_("pre",{pre:!0,attrs:{class:"language-bash"}},[_("code",[_("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" -ant"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/^tcp/ {++S[$NF]} END {for(a in S) print (a,S[a])}'")]),t._v("\n")])])]),_("p",[t._v("结果输出：")]),t._v(" "),_("p",[t._v("LAST_ACK 63"),_("br"),t._v("\nLISTEN 39"),_("br"),t._v("\nSYN_RECV 75"),_("br"),t._v("\nCLOSE_WAIT 46"),_("br"),t._v("\nESTABLISHED 96754"),_("br"),t._v("\nFIN_WAIT1 60"),_("br"),t._v("\nFIN_WAIT2 59"),_("br"),t._v("\nCLOSING 11"),_("br"),t._v("\nSYN_SENT 98"),_("br"),t._v("\nTIME_WAIT 70")]),t._v(" "),_("h2",{attrs:{id:"tcp连接状态表说明"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#tcp连接状态表说明"}},[t._v("#")]),t._v(" TCP连接状态表说明")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("状态")]),t._v(" "),_("th",[t._v("说明")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("CLOSED")]),t._v(" "),_("td",[t._v("表示TCP连接是“关闭着的”或“未打开的”。")])]),t._v(" "),_("tr",[_("td",[t._v("LISTEN")]),t._v(" "),_("td",[t._v("服务器端的某个SOCKET处于监听状态，可以接受客户端的连接。")])]),t._v(" "),_("tr",[_("td",[t._v("SYN_SENT")]),t._v(" "),_("td",[t._v("表示客户端已发送SYN报文。客户端的SOCKET执行connect()进行连接时，首先发送SYN报文，随后进入到SYN_SENT状态，等待服务端的确认报文。")])]),t._v(" "),_("tr",[_("td",[t._v("SYN_RCVD")]),t._v(" "),_("td",[t._v("表示服务端接收到了客户端请求连接的SYN报文。同时服务端也会回送ACK确认报文给客户端。")])]),t._v(" "),_("tr",[_("td",[t._v("ESTABLISHED")]),t._v(" "),_("td",[t._v("表示TCP连接已经成功建立，正常数据传输状态。")])]),t._v(" "),_("tr",[_("td",[t._v("FIN_WAIT1")]),t._v(" "),_("td",[t._v("SOCKET在ESTABLISHED状态时，调用close()主动关闭连接，向对方发送了FIN报文，然后进入到FIN_WAIT1状态。")])]),t._v(" "),_("tr",[_("td",[t._v("FIN_WAIT2")]),t._v(" "),_("td",[t._v("SOCKET在FIN_WAIT1状态时，收到对方的ACK响应报文后，则进入到FIN_WAIT2状态。"),_("em",[t._v("注：FIN_WAIT2是没有超时时钟，累积越来越多的FIN_WAIT2状态会导致内核crash。")])])]),t._v(" "),_("tr",[_("td",[t._v("TIME_WAIT")]),t._v(" "),_("td",[t._v("SOCKET在FIN_WAIT2状态时，收到了对方的FIN报文，并发送出了ACK报文，则进入到TIME_WAIT状态。此状态下的TCP连接会等待2*MSL(Max Segment Lifetime，最大分段生存期，指一个TCP报文在Internet上的最长生存时间)")])]),t._v(" "),_("tr",[_("td",[t._v("CLOSING")]),t._v(" "),_("td",[t._v("两边同时尝试关闭。")])]),t._v(" "),_("tr",[_("td",[t._v("CLOSE_WAIT")]),t._v(" "),_("td",[t._v("表示正在等待关闭。服务端收到客户端的FIN报文请求断开后，给客户端响应ACK确认服务，此时服务端TCP进入CLOSE_WAIT状态。等待服务端发送未传完的数据后再关闭服务端与客户端方向的连接。")])]),t._v(" "),_("tr",[_("td",[t._v("LAST_ACK")]),t._v(" "),_("td",[t._v("SOCKET在CLOSE_WAIT状态时，发送FIN报文后，等待对方的ACK报文的时候，就处于LAST_ACK状态。当收到对方的ACK报文后，也就可以进入到CLOSED 可用状态了。")])])])]),t._v(" "),_("h2",{attrs:{id:"常用用法"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#常用用法"}},[t._v("#")]),t._v(" 常用用法")]),t._v(" "),_("ol",[_("li",[_("p",[t._v("查找请求数前20个IP（常用于查找攻来源）")]),t._v(" "),_("div",{staticClass:"language-linux extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("netstat -anlp |grep 80 |grep tcp |awk '{print $5}' |awk -F: '{print $1}' |sort |uniq -c |sort -nr |head -n20\n")])])])]),t._v(" "),_("li",[_("p",[t._v("查找较多time_wait连接")]),t._v(" "),_("div",{staticClass:"language-linux extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("netstat -n |grep TIME_WAIT |awk '{print $5}' |sort |uniq -c |sort -rn  \n")])])])]),t._v(" "),_("li",[_("p",[t._v("找查较多的SYN连接")]),t._v(" "),_("div",{staticClass:"language-linux extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("netstat -an | grep SYN | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr\n")])])])]),t._v(" "),_("li",[_("p",[t._v("找查较多的FIN_WAIT2连接")]),t._v(" "),_("div",{staticClass:"language-linux extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("netstat -an | grep FIN_WAIT2 | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr\n")])])])])])])}),[],!1,null,null,null);_.default=s.exports}}]);