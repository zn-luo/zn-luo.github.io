(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{403:function(t,s,v){"use strict";v.r(s);var a=v(17),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"kubeadmin-安装k8s-v-111-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubeadmin-安装k8s-v-111-1"}},[t._v("#")]),t._v(" kubeadmin 安装k8s v.111.1")]),t._v(" "),s("p",[t._v("此部署方案使用ansible来进行跨主机安装所需软件及修改相应配置,基本所有的部署流程都已经kube-install.yml实现。"),s("br"),t._v("\n网络插件使用weave，存储插件使用基于rook的ceph存储。")]),t._v(" "),s("h2",{attrs:{id:"部署准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署准备"}},[t._v("#")]),t._v(" 部署准备")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("资源")]),t._v(" "),s("th",[t._v("配置")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("CPU")]),t._v(" "),s("td",[t._v(">=2")])]),t._v(" "),s("tr",[s("td",[t._v("内存")]),t._v(" "),s("td",[t._v(">=8GB")])]),t._v(" "),s("tr",[s("td",[t._v("磁盘")]),t._v(" "),s("td",[t._v(">=2块")])]),t._v(" "),s("tr",[s("td",[t._v("系统盘")]),t._v(" "),s("td",[t._v(">=30GB")])]),t._v(" "),s("tr",[s("td",[t._v("服务器")]),t._v(" "),s("td",[t._v("最好3台")])]),t._v(" "),s("tr",[s("td",[t._v("网卡数量")]),t._v(" "),s("td",[t._v(">=1")])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("软件")]),t._v(" "),s("th",[t._v("版本")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Ubuntu")]),t._v(" "),s("td",[t._v("18.04.2")])]),t._v(" "),s("tr",[s("td",[t._v("kernel")]),t._v(" "),s("td",[t._v(">=3.10")])]),t._v(" "),s("tr",[s("td",[t._v("docker-ce")]),t._v(" "),s("td",[t._v("18.06.3~ce~3-0~ubuntu")])]),t._v(" "),s("tr",[s("td",[t._v("kubeadm")]),t._v(" "),s("td",[t._v("v1.11.1")])]),t._v(" "),s("tr",[s("td",[t._v("kubelet")]),t._v(" "),s("td",[t._v("v1.11.1")])]),t._v(" "),s("tr",[s("td",[t._v("kubectl")]),t._v(" "),s("td",[t._v("v1.11.1")])])])]),t._v(" "),s("p",[t._v("备注：保证服务器之前网络互通，可以访问外网，docker.io")]),t._v(" "),s("h2",{attrs:{id:"下载部署所需文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载部署所需文件"}},[t._v("#")]),t._v(" 下载部署所需文件")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"/files/k8s/scripts/install-docker-ce.sh"}},[t._v("install-docker-ce.sh")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/scripts/install-k8s.sh"}},[t._v("install-k8s.sh")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/scripts/k8s-inventory"}},[t._v("k8s-inventory")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/kube-install.yml"}},[t._v("kube-install.yml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/kubeadm.yaml"}},[t._v("kubeadm.yaml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/weave-daemonset-k8s-1.7.yaml"}},[t._v("weave-daemonset-k8s-1.7.yaml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/k8s-dashboard-v1.10.1.yaml"}},[t._v("k8s-dashboard-v1.10.1.yaml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/rook-ceph-common-1.3.yaml"}},[t._v("rook-ceph-common-1.3.yaml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/rook-ceph-operator-1.3.yaml"}},[t._v("rook-ceph-operator-1.3.yaml")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/files/k8s/ymls/rook-ceph-cluster-1.3.yaml"}},[t._v("rook-ceph-cluster-1.3.yaml")])])]),t._v(" "),s("p",[t._v("备注： 所有文件应该下载在相同目录")]),t._v(" "),s("h2",{attrs:{id:"安装部署k8s-v1-11-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装部署k8s-v1-11-1"}},[t._v("#")]),t._v(" 安装部署k8s v1.11.1")]),t._v(" "),s("p",[t._v("进入刚才下载部署所需的文件目录,执行如下操作")]),t._v(" "),s("ol",[s("li",[t._v("在当前主机配置/etc/hosts, 设置ip与主机名")]),t._v(" "),s("li",[t._v("编辑k8s-inventory，配置好主机名，ssh用户名密码等")]),t._v(" "),s("li",[t._v("执行如下命令:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" install-docker-ce.sh installDockerce "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#如果已经安装docker-ce可不用执行")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" install-k8s.sh           "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#此部署脚本可重复执行，如果遇到网络问题突然中断可重复执行")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);