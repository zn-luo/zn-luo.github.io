(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{438:function(r,t,a){"use strict";a.r(t);var e=a(17),n=Object(e.a)({},(function(){var r=this,t=r._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[t("h1",{attrs:{id:"vxlan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vxlan"}},[r._v("#")]),r._v(" "),t("a",{attrs:{href:"https://support.huawei.com/enterprise/zh/doc/EDOC1100087027",target:"_blank",rel:"noopener noreferrer"}},[r._v("VXLAN"),t("OutboundLink")],1)]),r._v(" "),t("p",[r._v("VXLAN全称叫Virtual eXtentible Local Area Network, 即虚拟扩展局域网。 是由IETF定义的NVO3(Network Virtualization over Layer 3)标准技术之一, 是对VLAN的一种扩展。VXLAN的特点是将L2的以太帧封装到UDP报文中(即L2 over L4),并在L3网络中传输。")]),r._v(" "),t("p",[r._v("VXLAN逻辑上是一种隧道技术，在源网络设备与目的网络设备之间的IP网络上，建立一条逻辑隧道，将用户侧报文经过特定的封装后通过这条隧道转发。从用户的角度来看，接入网络的服务器就像是连接到了一个虚拟的二层交换机的不同端口上，可以方便地通信。")]),r._v(" "),t("h2",{attrs:{id:"vxlan需求场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vxlan需求场景"}},[r._v("#")]),r._v(" VXLAN需求场景")]),r._v(" "),t("ul",[t("li",[r._v("服务器虚拟化后的虚拟机动态迁移，需要提供一个无障碍接入的网络")]),r._v(" "),t("li",[r._v("数据中心规模越发庞大，租户数量激增，需要网络提供隔离海量租户的能力")])]),r._v(" "),t("h2",{attrs:{id:"vxlan报文格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vxlan报文格式"}},[r._v("#")]),r._v(" VXLAN报文格式")]),r._v(" "),t("p",[t("img",{attrs:{src:"/imgs/network/vxlan/VXLAN%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F.png",alt:"VXLAN报文格式"}}),t("br"),r._v("\n如上图所示，VTEP对VM发送的原始以太帧(Original L2 Frame)进行封装:")]),r._v(" "),t("ul",[t("li",[r._v("VXLAN Header"),t("br"),r._v("\n在原始以太帧数据包基础上增加8字节的VXLAN头，包含24bit的VNI字段，用来定义VXLAN网络中不同的租户。还有8bit的VXLAN Flags和两个保留字段(分别为24bit和8bit)")]),r._v(" "),t("li",[r._v("UDP Header"),t("br"),r._v("\nVXLAN头和原始以太帧一起作为UDP的数据。UDP头中的目的端口号(VXLAN Port)固定为4789,源端口号(UDP Src. Port)是原始以太帧通过哈希算法计算后的值。")]),r._v(" "),t("li",[r._v("Outer IP Header"),t("br"),r._v("\n封装外层IP头。其中，源IP地址(Src. IP)为源VM所属VTEP的IP地址，目的IP地址(Dst. IP)为目的VM所属VTEP的IP地址。")]),r._v(" "),t("li",[r._v("Outer MAC Header"),t("br"),r._v("\n封装外层以太头。其中源MAC地址(Src. MAC Addr.)为源VM所属VTEP的MAC地址，目的MAC地址(Dst. MAC Addr.)为到达目的VTEP的路径中下一跳设备的MAC地址。")])])])}),[],!1,null,null,null);t.default=n.exports}}]);